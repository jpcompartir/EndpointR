% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/anthropic_messages.R
\name{ant_complete_chunks}
\alias{ant_complete_chunks}
\title{Process text chunks through Anthropic's Messages API with batch file output}
\usage{
ant_complete_chunks(
  texts,
  ids,
  chunk_size = 5000L,
  model = "claude-haiku-4-5",
  system_prompt = NULL,
  output_dir = "auto",
  schema = NULL,
  concurrent_requests = 5L,
  temperature = 0,
  max_tokens = 1024L,
  max_retries = 5L,
  timeout = 30L,
  key_name = "ANTHROPIC_API_KEY",
  endpoint_url = .ANT_MESSAGES_ENDPOINT,
  id_col_name = "id"
)
}
\arguments{
\item{texts}{Character vector of texts to process}

\item{ids}{Vector of unique identifiers (same length as texts)}

\item{chunk_size}{Number of texts per chunk before writing to disk}

\item{model}{Anthropic model to use}

\item{system_prompt}{Optional system prompt (applied to all requests)}

\item{output_dir}{Directory for parquet chunks ("auto" generates timestamped dir)}

\item{schema}{Optional JSON schema for structured output}

\item{concurrent_requests}{Number of concurrent requests}

\item{temperature}{Sampling temperature}

\item{max_tokens}{Maximum tokens per response}

\item{max_retries}{Maximum retry attempts per request}

\item{timeout}{Request timeout in seconds}

\item{key_name}{Environment variable name for API key}

\item{endpoint_url}{Anthropic API endpoint URL}

\item{id_col_name}{Name for ID column in output}
}
\value{
A tibble with all results
}
\description{
Processes large volumes of text through Anthropic's Messages API in
configurable chunks, writing results progressively to parquet files.
Handles concurrent requests, automatic retries, and structured outputs.
}
\details{
This function is designed for processing large text datasets. It divides
input into chunks, processes each chunk with concurrent API requests, and
writes results to disk to minimise memory usage and possibility of data loss.

Results are written as parquet files in the specified output directory,
along with a metadata.json file containing processing parameters.

When using the \verb{output_dir =} argument, be careful that you select
a new directory if you do not wish to overwrite existing chunks.
If there is already a \code{chunks_001.parquet} file in the directory,
it will be overwritten.
}
